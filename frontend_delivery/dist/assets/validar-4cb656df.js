import{_ as V,b as r,d as E,u as b,r as g,o as z,c as C,e as n,t as L,a as u,w as M,f as v,U as k,g as D}from"./index-147646d1.js";const S={style:{margin:"auto","max-width":"50rem","margin-top":"8rem"}},N={style:{width:"100%"}},$={style:{width:"100%",display:"flex","flex-direction":"column",gap:"1rem"}},A={style:{display:"flex",width:"100%","justify-content":"end"}},G={__name:"validar",setup(O){const m=r("");E(async()=>{await _()});const y=async()=>new Promise((a,t)=>{if(typeof google<"u"){a();return}const e=document.createElement("script");e.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD1D4di1V3GaXtM5EL-4LGldvvz-fH0bPI&libraries=marker",e.async=!0,e.defer=!0,e.onload=a,e.onerror=t,document.head.appendChild(e)}),_=async()=>{try{await y(),l.value||(l.value=new google.maps.Map(p.value,{center:{lat:6.2717264431772985,lng:-75.55841542945669},zoom:14,minZoom:13,maxZoom:15}));const a=new google.maps.KmlLayer({url:"https://www.google.com/maps/d/kml?mid=1fAENw6dNOT4jjL4tNdUtRX4Cqor1iVD5&ehbc=2E312F=en",map:l.value,preserveViewport:!0});a.addListener("status_changed",()=>{a.getStatus()!==google.maps.KmlLayerStatus.OK&&console.error("Error al cargar el mapa desde KML:",a.getStatus())})}catch(a){console.error("Error al inicializar el mapa:",a)}};b();const f="AIzaSyD1D4di1V3GaXtM5EL-4LGldvvz-fH0bPI",h=r(""),l=r(null),c=r(null),p=r(null);r();const i=r({}),w=async a=>{const t=`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(a)}&key=${f}`;try{const e=await v.get(t),s=e.data.results;if(s.length===0)throw new Error("No se pudo encontrar la dirección");const{lat:o,lng:I}=s[0].geometry.location;return console.log(e),{lat:o,lng:I}}catch(e){throw console.error("Error al geocodificar la dirección:",e),e}},x=async()=>{try{if(!i.value.address||!d.value){alert("Por favor ingresa la dirección y el barrio.");return}const a=`${i.value.address}, ${d.value.name}, Medellín, Colombia`,{lat:t,lng:e}=await w(a);c.value&&c.value.setMap(null),c.value=new google.maps.Marker({position:{lat:t,lng:e},map:l.value,title:h.value,animation:google.maps.Animation.DROP}),l.value.setCenter({lat:t,lng:e}),l.value.setZoom(14);const o=(await v.post(`${k}/consultar_zona/`,{latitud:t,longitud:e})).data;o.zona?(alert(`Zona: ${o.zona}. Valor domicilio: ${o.valor_domicilio}`),m.value=o.zona,o.latitud&&o.longitud&&(l.value.setCenter({lat:o.latitud,lng:o.longitud}),l.value.setZoom(15))):alert("No se encontró cobertura.")}catch(a){alert(a.message||"Error al procesar la dirección.")}},d=r({delivery_price:0,name:""});return(a,t)=>{const e=g("InputText"),s=g("Button");return z(),C("div",S,[n("h1",null,[n("b",null," DOMICILIO: "+L(m.value),1)]),n("div",N,[n("div",$,[n("div",null,[u(e,{style:{width:"100%"},type:"text",modelValue:i.value.address,"onUpdate:modelValue":t[0]||(t[0]=o=>i.value.address=o),placeholder:"Ingresa una dirección"},null,8,["modelValue"])]),n("div",null,[u(e,{style:{width:"100%"},type:"text",modelValue:d.value.name,"onUpdate:modelValue":t[1]||(t[1]=o=>d.value.name=o),placeholder:"Ingresa un barrio"},null,8,["modelValue"])]),n("div",A,[u(s,{severity:"help",size:"small",style:{"font-weight":"bold"},onClick:x},{default:M(()=>[D("Validar")]),_:1})])])]),n("div",{class:"my-4",id:"map",ref_key:"mapContainer",ref:p,style:{"aspect-ratio":"4 / 2",width:"100%"}},null,512)])}}},U=V(G,[["__scopeId","data-v-ed707ed5"]]);export{U as default};
